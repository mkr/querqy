<?xml version="1.0" encoding="UTF-8" ?>

<config>

	<luceneMatchVersion>5.0.0</luceneMatchVersion>
	<directoryFactory name="DirectoryFactory" class="solr.RAMDirectoryFactory" />

	<dataDir>${solr.core0.data.dir:}</dataDir>

	<schemaFactory class="ClassicIndexSchemaFactory" />

    <indexConfig>
        <!-- Needed for RAMDirectoryFactory -->
        <lockType>single</lockType>
    </indexConfig>

	<updateHandler class="solr.DirectUpdateHandler2" />

	<requestDispatcher handleSelect="false">
		<requestParsers enableRemoteStreaming="false"
			multipartUploadLimitInKB="2048" formdataUploadLimitInKB="2048" />
	</requestDispatcher>

	<requestHandler name="/select" class="solr.SearchHandler">
		<lst name="defaults">
			<str name="echoParams">all</str>
			<int name="rows">10</int>
			<str name="df">id</str>
		</lst>

	</requestHandler>

	<requestHandler name="standard" class="solr.StandardRequestHandler"
		default="true" />
	<requestHandler name="/analysis/field" startup="lazy"
		class="solr.FieldAnalysisRequestHandler" />

	<queryParser name="querqy" class="querqy.solr.DefaultQuerqyDismaxQParserPlugin">

		<lst name="rewriteChain">
		   	<lst name="rewriter">
		   		<str name="class">querqy.solr.SimpleCommonRulesRewriterFactory</str>
               	<str name="rules">rules-before-wordbreaks.txt</str>
               	<bool name="ignoreCase">true</bool>
               	<str name="querqyParser">querqy.rewrite.commonrules.WhiteSpaceQuerqyParserFactory</str>
		   	</lst>
		   	<lst name="rewriter">
		   		<str name="class">querqy.solr.contrib.WordBreakCompoundRewriterFactory</str>
				 	<str name="dictionaryField">f1</str>
				 	<arr name="reverseCompoundTriggerWords">
						<str>für</str>
						<str>aus</str>
					</arr>
			    <bool name="decompound.verifyCollation">true</bool>
					<bool name="lowerCaseInput">true</bool>
		   	</lst>
		 </lst>

		 <lst name="parser">
         	<str name="factory">querqy.solr.SimpleQuerqyQParserFactory</str>
         	<str name="class">querqy.parser.WhiteSpaceQuerqyParser</str>
     	 </lst>

	</queryParser>

	<queryParser name="querqyDE" class="querqy.solr.DefaultQuerqyDismaxQParserPlugin">

		<lst name="rewriteChain">
			<lst name="rewriter">
				<str name="class">querqy.solr.SimpleCommonRulesRewriterFactory</str>
				<str name="rules">rules-before-wordbreaks.txt</str>
				<bool name="ignoreCase">true</bool>
				<str name="querqyParser">querqy.rewrite.commonrules.WhiteSpaceQuerqyParserFactory</str>
			</lst>
			<lst name="rewriter">
				<str name="class">querqy.solr.contrib.WordBreakCompoundRewriterFactory</str>
				<str name="dictionaryField">f1</str>
				<str name="morphology">GERMAN</str>
				<arr name="reverseCompoundTriggerWords">
					<str>für</str>
					<str>aus</str>
				</arr>
				<bool name="decompound.verifyCollation">true</bool>
				<bool name="lowerCaseInput">true</bool>
			</lst>
		</lst>

		<lst name="parser">
			<str name="factory">querqy.solr.SimpleQuerqyQParserFactory</str>
			<str name="class">querqy.parser.WhiteSpaceQuerqyParser</str>
		</lst>

	</queryParser>

	<queryParser name="querqyNoCollationNoLowerCase" class="querqy.solr.DefaultQuerqyDismaxQParserPlugin">

			<lst name="rewriteChain">
					<lst name="rewriter">
							<str name="class">querqy.solr.SimpleCommonRulesRewriterFactory</str>
							<str name="rules">rules-before-wordbreaks.txt</str>
							<bool name="ignoreCase">true</bool>
							<str name="querqyParser">querqy.rewrite.commonrules.WhiteSpaceQuerqyParserFactory</str>
					</lst>
					<lst name="rewriter">
							<str name="class">querqy.solr.contrib.WordBreakCompoundRewriterFactory</str>
							<str name="dictionaryField">f1</str>
							<bool name="decompound.verifyCollation">false</bool>
							<bool name="lowerCaseInput">false</bool>
					</lst>

			</lst>

			<lst name="parser">
					<str name="factory">querqy.solr.SimpleQuerqyQParserFactory</str>
					<str name="class">querqy.parser.WhiteSpaceQuerqyParser</str>
			</lst>

	</queryParser>

	<queryParser name="querqyWithProtectedWords" class="querqy.solr.DefaultQuerqyDismaxQParserPlugin">

		<lst name="rewriteChain">
			<lst name="rewriter">
				<str name="class">querqy.solr.contrib.WordBreakCompoundRewriterFactory</str>
				<str name="dictionaryField">f1</str>
				<bool name="decompound.verifyCollation">false</bool>
				<bool name="lowerCaseInput">true</bool>
				<arr name="protectedWords">
					<str>wissenschaft</str>
				</arr>
			</lst>
		</lst>

		<lst name="parser">
			<str name="factory">querqy.solr.SimpleQuerqyQParserFactory</str>
			<str name="class">querqy.parser.WhiteSpaceQuerqyParser</str>
		</lst>

	</queryParser>

	<admin>
		<defaultQuery>solr</defaultQuery>
	</admin>

</config>

